---
title: Dynamics in Algorithmic Recourse
subtitle: Trustworthy Artificial Intelligence for Finance and Economics
format:
    pdf:
        documentclass: acmconf
        number-sections: true
        include-in-header: preamble.tex
        keep-tex: true
---

## Introduction

Recent advances in artificial intelligence (AI) have propelled its adoption in domains outside of computer science including health care, bioinformatics and genetics. In finance, economics and other social sciences, applications of AI are still relatively limited. Decision-making in these fields has traditionally been guided by Generalized Linear Models (GLM), which are theoretically founded, interpretable and often sufficient to model relationships between variables. Model interpretability is crucial in the social sciences context, because inference is typically at least as important as predictive performance. Decision-makers in the social sciences are also typically required to explain their decisions to human stakeholders: central bankers, for example, are held accountable by the public for the policies they decide on. It is therefore not surprising that practitioners and academics in these fields are reluctant to adopt AI technologies that ultimately cannot be trusted. Deep learning models, for example, are generally considered as black boxes and therefore difficult to apply in a context that demands explanations. This PhD project is focused on exploring and developing methodologies that improve the trustworthiness of AI and thereby enable its application in Finance and Economics. 

The remainder of this extended abstract is structured as follows: @sec-main presents one of the research questions I have investigated during the first months of my PhD: how do counterfactual explanations handle dynamics? @sec-related places this work in the broader context of Trustworthy AI for Finance and Economics.

## Dynamics in Algorithmic Recourse {#sec-main}

**Counterfactual explanations** (CE) explain how inputs into a model need to change for it to produce different outputs. They are intuitive, simple and intrinsically linked to the potential outcome framework for causal inference, which social scientists are familiar with. Counterfactual explanations that involve realistic and actionable changes can be used for the purpose of **Algorithmic Recourse** (AR) to help individuals facing adverse decisions. An example relevant to the Finance and Econonomics domain is consumer credit: in this context AR can be used to guide individuals to improve their credit worthiness, should they have previously been denied access to credit based on a black-box decision-making system . 

Existing work on CE and AR has largely been limited to the static setting: given some classifier $M: \mathcal{X} \mapsto \mathcal{Y}$ we are interested in finding close [@wachter2017counterfactual], actionable [@ustun2019actionable], plausible [@joshi2019towards, @antoran2020getting, @schut2021generating], sparse [@schut2021generating], diverse [@mothilal2020explaining] and ideally causally founded counterfactual explanations [@karimi2021algorithmic] for some individual $x$. The ability of counterfactual explanations to handle dynamics like data and model shifts remains a largely unexplored research challenge at this point [@verma2020counterfactual]. Only one recent work considers the implications of **exogenous** domain shifts on the validity of recourse [@upadhyay2021towards]. The authors propose a simple minimax objective, that minimizes the counterfactual loss function for a maximal domain and model shift. They show that their approach yields more robust counterfactuals than existing approaches. 

This project investigates **endogenous** domain and model shifts, that is shifts that occur when AR is actually impemented by a proportion of individuals and the classifier is updated in response. @fig-dynamics illustrates this idea for a binary problem involving a probabilistic classifier and a greedy counterfactual generator proposed by @schut2021generating: AR leads to a domain shift, which in turn causes a drastic model shift. As this game of implementing AR and updating the classifier is repeated, the decision boundary moves in the opposite direction of the original training samples in the target class. We consider several aspects of these dynamics as problematic. Firstly, as the decision boundary moves in the direction of the non-target class, counterfactual paths become shorter: in the loan example, individuals that previously would have been denied credit based on their input features are suddenly considered as credit worthy. Average default risk across all borrowers can therefore be expected to increase. Conversely, lenders that anticipate or detect these sorts of dynamics may choose to still deny credit to individuals that have implemented AR, thereby comprimising the validity of AR. 

To the best of my knowledge this is the first work investigating endogenous dynamic in algorithmic recourse. In future experiments I want to investigate how this phenomenon plays out across different benchmark datasets (including German credit [@germancredit1994], Boston Housing [@boston1993] and COMPAS [@compas2016]). Furthermore, I want to asses to what extent the magnitude and direction of domain and model shifts depends on the choice of the counterfactual generator. To this end, I am currently supervising a group of undergraduate students, who are tackling some of these tasks in their final-year research project. 

![PLACEHOLDER: The dynamics of algorithmic recourse.](www/dynamics.png){#fig-dynamics fig.pos="h" width=250px}

## Related and Future Work {#sec-related}

### Benchmarking CE in Julia

Until recently there existed only one open-source library that provides a unifying approach to generate and benchmark counterfactual explanations for models built and trained in Python [@pawelczyk2021carla]. To address this limitation I have developed [CounterfactualExplanations.jl](https://www.paltmeyer.com/CounterfactualExplanations.jl/stable/): a Julia package that can be used to generate counterfactual explanations for models developed and trained not only in Julia, but also in other popular programming languages like Python and R. The package and companion paper are currently pending acceptance for a main talk at [JuliaCon](https://juliacon.org/2022/). 

### Probabilistic Methods for Realistic CE

To ensure that the generated explanations are realistic it is important to understand which input-output pairs are likely and which are not. To quantify their joint likelihood, previous work has either relied on generative models or restricted the analysis to probabilistic models that incorporate uncertainty in their predictions. While the former approach is more versatile since it is applicable to both deterministic and probabilistic models, the latter is computationally much more efficient. The approach proposed by @schut2021generating and used to generate the examples in @fig-dynamics falls into the latter category. In future work I want to explore how recent advances in post-hoc uncertainty quantification, most notably Laplace Redux [@daxberger2021laplace], can be leveraged to generate realistic and unambiguous counterfactual explanations for any model.^[For some initial work on this see my Julia implementation of Laplace Redux: [BayesLaplace.jl](https://www.paltmeyer.com/BayesLaplace.jl/dev/).]

### XAI for Time Series Models

Datasets in Finance and Economics often involve autoregressive time series, which is modelled differently than static, cross-sectional data. One popular approach to macroeconomic forecasting, for example, is Vector Autoregression (VAR), which involves an interpretable system of linear equations. Recent work has shown that machine learning can be leveraged in this context to improve forecasting performance, albeit at the sacrifice of explainability [@altmeyer2021deep].^[For an open-source implementation of our approach see [deepvars](https://github.com/pat-alt/deepvars): an R package Deep Vector Autoregression]. Through my PhD research I hope to ultimately adress that shortfall through explainable AI and probabilistic methods.

#### Counterfactual Explanations

I would like to investigate if and how CE can be used to leverage machine learning for time series forecasting without sacrificing explainability. In the context of conventional VAR counterfactual outcomes are actually well-studied [@kilian2017structural], which makes macroeconomic forecasting and interesting case study. More generally though, work on applying CE to black-box models for time series data has so far been limited and therefore warrants attention. 

#### Probabilistic Methods

I am also interested in seeing if and how Laplace Redux can be applied to reccurent neural networks. 

## References